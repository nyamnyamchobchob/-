<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>한능검 퀴즈 확장판</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; background: #f0f4f8; }
  h1 { text-align: center; }
  .quiz-container { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  .question { font-size: 1.2em; margin-bottom: 15px; }
  .options { list-style: none; padding: 0; }
  .options li { margin: 10px 0; }
  button { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
  button.correct { background-color: #4CAF50; color: white; }
  button.wrong { background-color: #f44336; color: white; }
  .stats { margin-top: 20px; font-size: 0.9em; }
</style>
</head>
<body>
<h1>한능검 퀴즈 확장판</h1>
<div class="quiz-container">
  <div class="question" id="question">문제 로딩 중...</div>
  <ul class="options" id="options"></ul>
  <div class="stats" id="stats"></div>
  <button onclick="nextQuestion()">다음 문제</button>
</div>

<script>
const quizData = [
  {keyword: "고조선", answer: "고인돌"},
  {keyword: "위만조선", answer: "위만"},
  {keyword: "왕검성", answer: "왕검성"},
  {keyword: "비파형 동검", answer: "비파형 동검"},
  {keyword: "부여", answer: "온조"},
  {keyword: "백제", answer: "고이왕"},
  {keyword: "고구려", answer: "주몽"},
  {keyword: "신라", answer: "박혁거세"}
];

// LocalStorage에서 기록 가져오기
let stats = JSON.parse(localStorage.getItem("quizStats")) || {correct:0, wrong:0};

function saveStats() {
  localStorage.setItem("quizStats", JSON.stringify(stats));
  document.getElementById("stats").textContent = `맞힌 문제: ${stats.correct}개, 틀린 문제: ${stats.wrong}개`;
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Type2 보기 생성: 정답 포함 + 나머지 3개 랜덤
function generateOptions(answer) {
  const otherOptions = quizData.map(q => q.answer).filter(a => a !== answer);
  shuffleArray(otherOptions);
  const options = [answer, ...otherOptions.slice(0,3)];
  shuffleArray(options);
  return options;
}

let currentQuestion;

function loadQuestion() {
  const randomIndex = Math.floor(Math.random() * quizData.length);
  currentQuestion = quizData[randomIndex];
  document.getElementById("question").textContent = `${currentQuestion.keyword}와 관련된 것은?`;
  
  const options = generateOptions(currentQuestion.answer);
  
  const optionsContainer = document.getElementById("options");
  optionsContainer.innerHTML = "";
  options.forEach(opt => {
    const li = document.createElement("li");
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = () => checkAnswer(opt, btn);
    li.appendChild(btn);
    optionsContainer.appendChild(li);
  });
}

function checkAnswer(selected, btn) {
  const buttons = document.querySelectorAll("#options button");
  buttons.forEach(b => b.disabled = true);

  if(selected === currentQuestion.answer){
    btn.classList.add("correct");
    stats.correct++;
  } else {
    btn.classList.add("wrong");
    stats.wrong++;
    buttons.forEach(b => {
      if(b.textContent === currentQuestion.answer) b.classList.add("correct");
    });
  }
  saveStats();
}

function nextQuestion() {
  loadQuestion();
}

saveStats();
loadQuestion();
</script>
</body>
</html>

